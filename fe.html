<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Category Viewer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/css/bootstrap.min.css">
    <style>
        .category-list {
            list-style-type: none;
            padding: 0;
        }
        .category-list li {
            cursor: pointer;
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Categories</h1>
        <div id="carousel" class="carousel slide" data-bs-ride="carousel">
            <div class="carousel-inner" id="carousel-inner"></div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
        <ul class="category-list" id="category-list"></ul>
    </div>
    
    <div id="file-list" style="display:none;">
        <h2>Files</h2>
        <ul id="files"></ul>
        <button onclick="goBack()">Back</button>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
    <script>
        $(document).ready(function() {
            $.getJSON('/data', function(data) {
                let categoryList = $('#category-list');
                let carouselInner = $('#carousel-inner');
                $.each(data, function(category, info) {
                    let listItem = $('<li>').text(category).click(function() {
                        showFiles(category, info.files);
                    });
                    categoryList.append(listItem);
                    
                    if (info.images.length > 0) {
                        $.each(info.images, function(index, img) {
                            let carouselItem = $('<div>').addClass('carousel-item' + (index === 0 ? ' active' : ''));
                            let image = $('<img>').addClass('d-block w-100').attr('src', img);
                            carouselItem.append(image);
                            carouselInner.append(carouselItem);
                        });
                    }
                });
            });
        });

        function showFiles(category, files) {
            $('#category-list').hide();
            $('#file-list').show();
            $('#files').empty();
            $.each(files, function(index, file) {
                let fileItem = $('<li>').append($('<a>').attr('href', file.url).text(file.name));
                $('#files').append(fileItem);
            });
        }

        function goBack() {
            $('#file-list').hide();
            $('#category-list').show();
        }
    </script>
</body>
</html>
